# 手写数字识别系统 (Handwritten Digit Recognition)

基于 PyTorch 实现的手写数字识别系统，支持多种模型训练、CPU/GPU 性能对比及错误案例分析，针对 MNIST 数据集进行优化。

## 项目功能
- 实现多种神经网络模型（改进 CNN、基础 CNN、简单全连接网络）
- 支持 CPU 与 GPU 训练性能对比（总耗时、加速比可视化）
- 批量验证 MNIST 测试集（支持全部 10000 张图片验证）
- 错误案例分析（按样本索引排序、错误分布统计、可视化展示）
- 数据增强与训练策略优化（早停、学习率调度、正则化等）

## 环境要求
- Python 3.8+
- PyTorch 2.2+
- torchvision
- matplotlib
- Pillow

安装依赖：pip install torch torchvision matplotlib pillow
## 文件结构handwritten_digitrecognition/
├── main.py　　　　　　　　# 主程序入口  
├── train.py　　　　　　　　# 模型训练模块  
├── predict.py　　　　　　　# 预测与验证模块  
├── models.py　　　　　　　# 神经网络模型定义  
├── utils.py　　　　　　　　 # 工具函数（设备选择、绘图等）  
├── data/　　　　　　　　　# 数据集（自动下载 MNIST）  
├── error_samples/　　　　　# 错误案例图片（自动生成）  
└── *.pth　　　　　　　　　　# 训练好的模型权重（自动保存）  
              
## 使用方法

### 基础训练与验证
直接运行主程序：python main.py程序会自动执行以下步骤：对比 CPU 与 GPU 的训练速率、使用改进的 CNN 模型 (ImprovedCNN) 训练、验证全部 10000 张 MNIST 测试集图片、生成错误案例分析与可视化结果

### 调整参数
在 main.py 中可修改以下配置：model_type = 'ImprovedCNN'  # 可选：'ImprovedCNN'、'CNN'、'SimpleFC'
epochs = 30                 # 训练轮次
batch_size = 128            # 批次大小
sample_size = 10000         # 验证样本数量（10000 为全部测试集）
num_to_show = 100           # 可视化错误案例数量
## 模型说明

| 模型名称       | 结构特点                          | 适用场景                  |
|----------------|-----------------------------------|---------------------------|
| ImprovedCNN    | 3 层卷积 + 批归一化 + Dropout     | 追求高准确率              |
| CNN            | 2 层基础卷积 + Dropout            | 平衡速度与准确率          |
| SimpleFC       | 简单全连接网络                    | 作为基线模型对比          |

## 优化策略
- 数据增强：随机旋转、平移、缩放、透视变换
- 正则化：Dropout、L2 正则化 (weight_decay)
- 训练策略：学习率自动衰减 (ReduceLROnPlateau)、早停策略 (Early Stopping)
- 网络优化：批归一化 (Batch Normalization)、更深的网络结构

## 结果说明
训练完成后会生成：
- 训练损失曲线与测试集准确率曲线
- CPU/GPU 训练速率对比图
- 错误案例图片（保存于 error_samples 目录）
- 错误分布统计（按数字分类）
- 模型权重文件（如 mnist_improvedcnn_model.pth）

## 常见问题
- **GPU 不可用**：程序会自动切换到 CPU 模式，不影响功能但训练速度较慢
- **模型文件已存在**：程序会自动删除旧模型并重新训练
- **可视化窗口关闭**：所有图表会按顺序显示，关闭一个后会显示下一个
- **数据集下载慢**：可手动下载 MNIST 数据集并放入 data/MNIST/raw 目录

## 版本更新说明（v2.0 对比 v1.x）

### 模型优化
#### 网络结构改进
- 新增 ImprovedCNN 模型，包含 3 层卷积 + 批归一化层，增强特征提取能力
- 增强正则化：添加 Dropout(0.5) 防止过拟合
- 加深网络深度，提升复杂特征学习能力

#### 训练策略升级
- 新增学习率调度器，自动衰减学习率以优化收敛
- 实现早停机制，避免无效训练轮次
- 增强数据增强：添加随机仿射变换和透视变换，提升模型泛化能力

### 功能拓展
#### 硬件性能对比
- 新增 compare_cpu_gpu_training 函数，支持自动对比 CPU/GPU 训练耗时
- 计算加速比并可视化，生成硬件性能对比图表

#### 错误案例分析
- 按样本索引升序排序错误案例，便于追溯
- 错误分布统计与可视化：数字错误频次统计、概率分布展示
- 自动保存错误样本图片，便于人工分析

### 使用体验提升
- 集中参数配置入口，便于快速调整实验参数
- 优化可视化图表布局，增强可读性
- 完善进度提示与结果输出，便于监控训练过程